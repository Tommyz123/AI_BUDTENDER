---
name: project-plan-fixer
description: 根据审核报告自动修复 PROJECT_PLAN.md 中的问题，生成新版本。
allowed-tools: Read, Grep, Glob, Edit, Write
---

# 修复项目计划书

## 执行步骤

1. 读取最新的 PROJECT_PLAN_vN.md
2. 读取审核报告 `PROJECT_PLAN_REVIEW.md`
3. 提取 P0 和 P1 问题列表
4. 按优先级修复：P0 → P1
5. 执行输出自检（SPEC.md 4.1）
6. 生成新版本 PROJECT_PLAN_v{N+1}.md
7. 输出修复记录

## 修复规则

1. **只修复审核报告中列出的问题**
2. **不添加报告未提及的修改**
3. **P0 + P1 自动修复，P2 询问用户**

## 常见问题修复方法

### P-S4: 维度9标题错误

```
问题：维度9是"部署安装"而非"测试与验证策略"
修复：
1. 将当前维度9重命名为维度10
2. 新增维度9"测试与验证策略"
3. 补充测试框架、测试类型、验收标准、测试命令
```

### P-S5: 缺少"初步可行性评估"

```
修复：在附录中添加：

### 初步可行性评估

| 维度 | 评分 | 理由 |
|------|------|------|
| 需求完整度 | {评估}/100 | {分析需求文档得出} |
| 技术可行性 | {评估}/100 | {分析技术栈得出} |
| 资源充足度 | {评估}/100 | {分析项目规模得出} |
| **综合评分** | {平均}/100 | - |
```

### P-C1: 技术选型有"A/B"写法

```
问题：数据库: PostgreSQL / MongoDB
修复：
1. 选择一个：数据库: PostgreSQL
2. 在备注列添加：替代方案：MongoDB（适用于NoSQL场景）
```

### P-C5: TODO标记过多

```
修复：
1. 逐个检查 <!-- TODO --> 标记
2. 根据需求文档和代码分析补充内容
3. 无法确定的保留 TODO 但添加说明
```

## 修复流程

```
1. 解析审核报告 → 提取问题列表
2. 对每个 P0 问题：
   - 定位修改位置
   - 应用修复方案
   - 记录修复状态
3. 对每个 P1 问题：
   - 同上
4. 执行自检（SPEC.md 4.1）
5. 如有未通过项 → 继续修复
6. 生成新版本文件
```

## 定位失败处理

如果无法精确定位修改位置：
1. 跳过该问题
2. 在修复记录中标记"⚠️ 需手动修复"
3. 继续处理下一个问题

## 输出自检

修复后必须对照 SPEC.md 4.1 检查：

```
□ 维度数量正确？
□ 维度9标题是"测试与验证策略"？
□ 有"初步可行性评估"章节？
□ 技术选型无"A / B"写法？
□ 核心模块 ≥ 3 个？
□ TODO标记 ≤ 10 个？
```

## 输出格式

**新版本文件**: PROJECT_PLAN_v{N+1}.md

**修复记录**: 见 [templates/fix-record.md](./templates/fix-record.md)
