---
name: project-plan-generator
description: 生成项目计划书（PROJECT_PLAN.md）。分析需求文档和代码库，根据项目阶段输出9/11/13个维度的规划文档。
allowed-tools: Read, Grep, Glob, Bash
---

# 生成项目计划书

## 执行步骤

1. 读取需求文档（requirements.md > README.md > 需求.txt > *.txt）
2. 分析代码库，判断项目阶段（见 SPEC.md 第1.5节）
3. 根据阶段生成对应维度（见 SPEC.md 第1.2节）
4. 生成初步可行性评估
5. 执行输出自检
6. 输出 PROJECT_PLAN_vN.md

## 项目阶段判断

| 阶段 | 条件 | 维度数 |
|------|------|-------|
| MVP期 | 代码<500行 或 模块≤2 或 "新建/创建" | 9 |
| 扩展期 | 代码<2000行 或 有数据库无部署 | 11 |
| 成熟期 | 代码≥2000行 或 "上线/生产" | 13 |

## 强制规则

1. MVP期必须输出维度1-9，**维度9是"测试与验证策略"**（不是部署安装）
2. 技术选型只写一个，禁止"PostgreSQL / MongoDB"写法
3. 替代方案放在表格的"备注"列
4. 核心模块 ≥ 3 个，每个模块标注扩展点
5. 必须输出"初步可行性评估"章节（4项评分）
6. TODO标记 ≤ 10 个

## 维度内容要求

详见 SPEC.md 第1.2节「维度定义」

关键要求：
- 维度3：架构图必须显示数据流
- 维度4：每项技术只推荐一个
- 维度5：每模块包含（职责、位置、接口、实现思路、扩展点）
- 维度9：必须有测试框架、测试类型、验收标准、测试命令

## 输出自检

生成后，对照 SPEC.md 第4.1节检查清单逐项验证：

```
□ 维度数量正确？（MVP=9, 扩展=11, 成熟=13）
□ 维度9标题是"测试与验证策略"？
□ 有"初步可行性评估"章节？
□ 技术选型无"A / B"写法？
□ 核心模块 ≥ 3 个？
□ TODO标记 ≤ 10 个？
```

**任何一项未通过 → 修正后再输出**

## 版本命名

- 检测当前目录是否存在 PROJECT_PLAN_v*.md
- 找到最大版本号 N，生成 v{N+1}
- 如果没有，从 v1 开始

## 输出模板

见 [templates/output-template.md](./templates/output-template.md)
